{{<layouts/1-column}}

	{{$h1}}Apply for a local discount{{/h1}}

	{{$column-1}}
		<form>
			<p>To claim your local discount, you will need to prove that you live in Dartford or Thurrock and that your vehicle is registered to your home address.</p>
			<fieldset class="inline">
				<h2 class="heading-24">What type of discount would you like?</h2>
				<p class="form-group form-group-compound" id="discount-boolean">
					<label class="block-label" for="crossings-unlimited">
						<input id="crossings-unlimited" type="radio" name="discount-group" value="Unlimited">
						Unlimited
					</label>
					<label class="block-label" for="crossings-limited">
						<input id="crossings-limited" type="radio" name="discount-group" value="limited">
						Limited
					</label>
				</p>
			</fieldset>
			<div class="form-group" id="proof">
				<h2 class="heading-24">Upload proof of residency</h2>
				<label class="visuallyhidden" for="proof-of-residence">Upload proof of residency</label>
				<input class="form-upload" id="proof-of-residence" name="proof-of-residence" type="file" />
			</div>
			<div>
				<h2 class="heading-24">Upload proof of ownership</h2>
				<label class="visuallyhidden" for="proof-of-ownership">Upload proof of ownership</label>
				<input class="form-upload" id="proof-of-ownership" name="proof-of-ownership" type="file" />
			</div>
			<div class="form-group">
				<h2 class="heading-24">Apply later</h2>
				<label class="form-checkbox" for="apply-later">
					<span class="form-hint">If you prefer, you can apply for your discount later</span>
					<input id="apply-later" type="checkbox" value="apply-later">
					Apply later
				</label>
			</div>
			<p><button class="button" disabled="disabled" id="next" type="submit">Save and continue</button></p>
		</form>
	{{/column-1}}

	{{$js-functions}}
		testNext = function() {
			if (el.applyLater.checked) {
				setDisabled(el.buttonNext, false);
			} else if (el.crossingsLimited.checked || el.crossingsUnlimited.checked) {
				if (
					el.proofOfOwnership.files.length > 0 &&
					el.proofOfResidence.files.length > 0
				) {
					console.log('w')
					setDisabled(el.buttonNext, false);
				}
			} else {
				setDisabled(el.buttonNext, true);
			}
		}
	{{/js-functions}}

	{{$js-initialisation}}
		init = function() {
			if (window.location.search.match(/=debug/)) {
				el.body.classList.add('debug');
			}
			el.applyLater.addEventListener('click', function() {
				testNext();
			}, false);
			el.buttonNext.addEventListener('click', function(e) {
				e.preventDefault();
				window.location = 'vehicle';
			});
			el.discountBoolean.addEventListener('click', function() {
				el.applyLater.checked = false;
				testNext();
			}, false);
			el.proofOfOwnership.addEventListener('change', function(e) {
				testNext();
			}, false);
			el.proofOfResidence.addEventListener('change', function(e) {
				testNext();
			}, false);
		}
	{{/js-initialisation}}

	{{$js-objects}}
		el = {
			applyLater: $('#apply-later'),
			buttonNext: $('#next'),
			crossingsLimited: $('#crossings-limited'),
			crossingsUnlimited: $('#crossings-unlimited'),
			discountBoolean: $('#discount-boolean'),
			proof: $('#proof'),
			proofOfOwnership: $('#proof-of-ownership'),
			proofOfResidence: $('#proof-of-residence')
		}
	{{/js-objects}}

{{/layouts/1-column}}
